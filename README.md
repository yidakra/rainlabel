# RainLabel

A video analysis and labeling tool that integrates with Google Cloud Video Intelligence API to analyze videos and provide an interactive web interface for viewing results.

## Features

- **Video Analysis**: Integration with Google Cloud Video Intelligence API for automated video analysis
- **Interactive Player**: HTML5 video player with synchronized metadata visualization
- **Label Navigation**: Click labels to jump to specific video segments
- **Timeline Visualization**: Visual timeline showing when labels appear in the video
- **Active Label Tracking**: Real-time display of labels currently visible in the video
- **Search & Filter**: Search through labels to find specific content
- **RESTful API**: Backend API serving video and metadata information

## Project Structure

```
rainlabel/
├── backend/           # FastAPI backend server
│   ├── main.py       # Main API server
│   └── requirements.txt
├── frontend/         # React frontend application
│   ├── src/
│   │   ├── components/
│   │   │   ├── VideoPlayer.js
│   │   │   ├── VideoList.js
│   │   │   ├── LabelsList.js
│   │   │   ├── Timeline.js
│   │   │   └── ActiveLabelPanel.js
│   │   ├── App.js
│   │   ├── index.js
│   │   └── index.css
│   ├── public/
│   └── package.json
├── videos/           # Video files storage
├── metadata/         # JSON metadata files
└── README.md
```

## API Endpoints

- `GET /videos` - List all available videos
- `GET /video/<name>` - Get specific video information
- `GET /metadata/<name>` - Get video analysis metadata
- `GET /static/videos/<filename>` - Serve video files

## Getting Started

### Prerequisites

- Python 3.8+
- Node.js 16+
- npm or yarn

### Backend Setup

1. Navigate to the backend directory:
   ```bash
   cd backend
   ```

2. Install Python dependencies:
   ```bash
   pip install -r requirements.txt
   ```

3. Run the FastAPI server:
   ```bash
   python main.py
   ```

The API will be available at `http://localhost:8000`

### Frontend Setup

1. Navigate to the frontend directory:
   ```bash
   cd frontend
   ```

2. Install Node.js dependencies:
   ```bash
   npm install
   ```

3. Start the React development server:
   ```bash
   npm start
   ```

The frontend will be available at `http://localhost:3000`

#### Note on esbuild override

We temporarily pin `esbuild` via the `overrides` field in `frontend/package.json` to `^0.25.9`. This ensures compatibility with our current `vite` toolchain, which may resolve to a newer `esbuild` version that causes install or build issues. If you update `vite` or related plugins, re-evaluate whether this override is still required.

### Adding Videos

1. Place video files (MP4, AVI, MOV, MKV, WebM) in the `videos/` directory
2. Add corresponding metadata JSON files in the `metadata/` directory

### Metadata Format

Metadata files should follow this structure:

```json
{
  "video_name": "sample_video",
  "labels": [
    {
      "description": "Person",
      "confidence": 0.95,
      "segments": [
        { "start": 0, "end": 30 },
        { "start": 45, "end": 120 }
      ]
    }
  ],
  "shots": [],
  "objects": [],
  "text": [],
  "faces": []
}
```

## Google Cloud Video Intelligence Integration

The application is designed to work with metadata generated by Google Cloud Video Intelligence API. The analysis script will be added to the repository later to automate the video analysis process.

## Development

### Running Both Services

To run both backend and frontend simultaneously:

1. Terminal 1 - Backend:
   ```bash
   cd backend && python main.py
   ```

2. Terminal 2 - Frontend:
   ```bash
   cd frontend && npm start
   ```

### Features Overview

- **Video List View**: Browse all available videos with metadata status
- **Video Player View**: Watch videos with synchronized label information
- **Label Panel**: Search and filter labels, click to jump to segments
- **Timeline**: Visual representation of label segments with click navigation
- **Active Labels**: Real-time display of currently visible labels

## License

This project is licensed under the GPL-3.0 License - see the LICENSE file for details.